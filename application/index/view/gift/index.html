{include file="public/header" /}
<style>

    .gift-title{
        background-color: #FF5722;
        text-align: center;
        color: #f5f8f9;
        border-radius: 8px;
        font-size: 20px;
        height: 40px;
        line-height: 40px;
    }

    .gift-list .gift-item{
        font-size: 16px;
        height: 40px;
        line-height: 40px;
        padding: 4px;
        overflow-x: auto;
    }

    .gift-list .gift-item .layui-badge{
        font-size: 16px;

    }

    .gift-num{
        color: #ff0000;
    }

    .layui-item{
        padding: 8px;
    }

</style>


<div class="layui-body" style="padding: 15px">
    <!-- 内容主体区域 -->
    <div class="layui-col-md6 layui-col-sm6 layui-col-xs12 layui-item">

        <div class="gift-title">
            今日排行榜
        </div>

        <ul class="gift-list" id="today">

        </ul>

    </div>
    <div class="layui-col-md6 layui-col-sm6 layui-col-xs12 layui-item">

        <div class="gift-title">
            本周排行榜
        </div>

        <ul class="gift-list" id="week">

        </ul>

    </div>

    <div class="layui-col-md6 layui-col-sm6 layui-col-xs12 layui-item">

        <div class="gift-title">
            历史排行榜
        </div>

        <ul class="gift-list" id="total">

        </ul>



    </div>


</div>

<script>
//JavaScript代码区域
layui.use(['element', 'form', 'layer', 'laypage'], function () {
    var element = layui.element
        , form = layui.form
        , laypage = layui.laypage
        , layer = layui.layer;

    $().ready(function () {

        // 获取今日榜单

        console.log('aa');

        getGift();

        function getGift() {

            var url = '/api/gift/getall';
            maskShow();

            $.post(
                url,
                {
                    'type':'all'
                },
                function(result){
                    maskClose();

                    if (result.code == 0){
                        setList(result.message);
                    }else{
                        layer.msg(result.message);

                    }

                },
                'json'
            );


        }

        function setList(data) {

            var today = data['today'];
            var week = data['week'];
            var total = data['total'];

            // 循环数据
            var todayList = getList(today);
            var weekList = getList(week);
            var totalList = getList(total);


            $('#today').empty().append(todayList);
            $('#week').empty().append(weekList);
            $('#total').empty().append(totalList);

        }

        
        function getList(giftData) {

            var giftList = '';

            for (var i=0;i<giftData.length;i++){

                giftList +=
                    '<li class="gift-item">' +
                    '    <span class="layui-badge layui-bg-blue">'+(i+1)+'</span>' +
                    '    <span>'+giftData[i]['gift_time']+'</span>' +
                    '    <span class="layui-badge layui-bg-blue">'+giftData[i]['username']+'</span>' +
                    '    <span class="layui-badge">'+giftData[i]['name']+'</span>' +
                    '    <span>X</span>' +
                    '    <span class="gift-num">'+giftData[i]['count']+'</span>' +
                    '</li>';
            }

            return giftList;
        }
        

    });


    function maskShow() {
        var index = layer.load();

        setTimeout(function(){
            layer.close(index);
        }, 5000);

    }

    function maskClose() {
        layer.closeAll('loading');
    }



});
</script>

{include file="public/footer" /}
